(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.XPSchema = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){

},{}],2:[function(require,module,exports){
module.exports=require("./lib");
},{"./lib":4}],3:[function(require,module,exports){
(function (global){
!function(e){"use strict";var n=e.XP||require("expandjs");module.exports=function(e,t){return n.isObject(t)?(n.forOwn(e,function(i,o){n.has(t,o)&&t[o].immutable&&delete e[o]}),e):e}}("undefined"!=typeof window?window:global);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"expandjs":1}],4:[function(require,module,exports){
(function (global){
!function(t){"use strict";var e=require("./filter"),i=require("./sanitize"),n=require("./validate"),s=t.XP||require("expandjs"),r=function(t){return s.has(t,"input")||s.has(t,"options")},u=function(t,e){return t=s.assign({handle:e},t),s.withdraw(t,"method"),t},o=s.freeze(s.keys(n.types)),a=s.freeze(s.filter(s.map(i.sanitizers,u),r)),f=s.freeze(s.filter(s.map(n.validators,u),r));module.exports=new s.Class("XPSchema",{options:{id:"",fields:null,strict:!1,useful:!1},initialize:function(t){var e=this;e.options=t,e.id=e.options.id,e.fields=e.options.fields||{},e.strict=e.options.strict,e.useful=e.options.useful},filter:{promise:!0,value:function(t,i){var n=this;s.attempt(function(i){i(null,e(n.ensure(t,"target"),n.fields,n.options))},i)}},sanitize:{promise:!0,value:function(t,e){var n=this;s.attempt(function(e){e(null,i(n.ensure(t,"target"),n.fields,n.options))},e)}},validate:{promise:!0,value:function(t,e){var i=this;s.attempt(function(e){e(null,n(i.ensure(t,"target"),i.fields,i.options))},e)}},ensure:{enumerable:!1,value:function(t,e){var i=this;switch(e){case"target":return s.isObject(t=JSON.parse(s.toJSON(t,i.options.useful)))?t:{};case"opt":return s.assign({},i.options,t);default:return t}}},fields:{set:function(t){return s.assign(t,s.zipObject(this.id,{type:"string"}))},validate:function(t){return s.isObject(t)}},id:{set:function(t){return this.id||t},validate:function(t){return s.isString(t,!0)}},sanitizers:{"static":!0,get:function(){return a}},strict:{set:function(t){return!!t}},types:{"static":!0,get:function(){return o}},useful:{set:function(t){return!!t}},validators:{"static":!0,get:function(){return f}}})}("undefined"!=typeof window?window:global);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./filter":3,"./sanitize":5,"./validate":6,"expandjs":1}],5:[function(require,module,exports){
(function (global){
!function(t){"use strict";var e=module.exports,i=t.XP||require("expandjs");e=module.exports=function(t,n,s,r){return i.isObject(n)?(i.forOwn(t,function(e,r){s.strict&&!i.has(n,r)&&delete t[r]}),i.forOwn(n,function(i,u){t[u]=e.sanitizeStep(t[u],n[u],n,s,(r?r+".":"")+u),s.useful&&null===t[u]&&delete t[u]}),t):t},e.sanitizeStep=function(t,n,s,r,u){return t=i.isDefined(t)?t:null,i.isObject(n)?(t=e.sanitizeValue(t,n,null,u),n.multi&&i.isArray(t)&&t.forEach(function(o,a){t[a]=e.sanitizeValue(o,n,a,u+"["+a+"]"),i.isObject(t[a])&&(n.fields||"recursive"===n.type)&&(t[a]=e(t[a],n.fields||s,i.assign({},r,{strict:n.strict}),u+"["+a+"]"))}),n.map&&i.isObject(t)&&(n.fields||"recursive"===n.type)&&(t=e(t,n.fields||s,i.assign({},r,{strict:n.strict}),u)),t):t},e.sanitizeValue=function(t,n,s,r){return t=i.isDefined(t)?t:null,i.isObject(n)?(i.isVoid(s)?t=(n.map?e.sanitizers.map:e.sanitizers.multi).method(t,n.multi,r):n.multi||(t=e.sanitizers.type.method(t,n.type,r)),i.forOwn(n,function(s,u){i.has(e.sanitizers,u)&&!i.includes(["map","multi","type"],u)&&(t=e.sanitizers[u].method(t,n[u],r))}),t):t},e.sanitizers={map:{method:function(t,e){return e?i.toObject(t,!0):t}},multi:{method:function(t,e){return e?i.toArray(t,!0):t}},type:{method:function(t,e){return"boolean"!==e?t:!!t}}}}("undefined"!=typeof window?window:global);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"expandjs":1}],6:[function(require,module,exports){
(function (global){
!function(e){"use strict";var t=module.exports,i=e.XP||require("expandjs");t=module.exports=function(e,n,r,a){return i.isObject(n)?(i.forOwn(n,function(i,u){t.validateStep(e[u],n[u],n,r,(a?a+".":"")+u)}),e):e},t.validateStep=function(e,n,r,a,u){return e=i.isDefined(e)?e:null,i.isObject(n)?(t.validateValue(e,n,null,u),n.multi&&i.isArray(e)&&e.forEach(function(e,s){t.validateValue(e,n,s,u+"["+s+"]"),i.isObject(e)&&(n.fields||"recursive"===n.type)&&t(e,n.fields||r,i.assign({},a,{strict:n.strict}),u+"["+s+"]")}),n.map&&i.isObject(e)&&(n.fields||"recursive"===n.type)&&t(e,n.fields||r,i.assign({},a,{strict:n.strict}),u),e):e},t.validateValue=function(e,n,r,a){var u;if(e=i.isDefined(e)?e:null,!i.isObject(n))return e;if(i.isVoid(r)){if(i.isError(u=(n.map?t.validators.map:t.validators.multi).method(e,n.multi,a)))throw u}else if(!n.multi&&i.isError(u=t.validators.type.method(e,n.type,a)))throw u;return i.forOwn(n,function(r,s){if(i.has(t.validators,s)&&!i.includes(["map","multi","type"],s)&&i.isError(u=t.validators[s].method(e,n[s],a)))throw u}),e},t.patterns={camelCase:i.camelCaseRegex,capitalize:i.capitalizeRegex,kebabCase:i.kebabCaseRegex,keyCase:i.keyCaseRegex,lowerCase:i.lowerCaseRegex,readable:i.readableRegex,snakeCase:i.snakeCaseRegex,startCase:i.startCaseRegex,trim:i.trimRegex,upperCase:i.upperCaseRegex},t.types={any:i.isAny,"boolean":i.isBoolean,number:i.isFinite,object:i.isObject,recursive:i.isObject,string:i.isString},t.validators={multi:{input:"checkbox",method:function(e,t,n){return i.xor(t,i.isArray(e))?new i.ValidationError(n||"target","should be a multi"):null}},map:{input:"checkbox",multi:!0,method:function(e,t,n){return i.xor(t,i.isObject(e))?new i.ValidationError(n||"target","should be an map"):null}},exclusiveMaximum:{input:"number",type:"number",method:function(e,t,n){return i.isFinite(e)&&i.isFinite(t)?e>=t?new i.ValidationError(n||"target","should be less than "+t):null:!1}},exclusiveMinimum:{input:"number",type:"number",method:function(e,t,n){return i.isFinite(e)&&i.isFinite(t)?t>=e?new i.ValidationError(n||"target","should be greater than "+t):null:!1}},maximum:{input:"number",type:"number",method:function(e,t,n){return i.isFinite(e)&&i.isFinite(t)?e>t?new i.ValidationError(n||"target","should be a maximum of "+t):null:!1}},maxItems:{attributes:{min:1},input:"number",multi:!0,method:function(e,t,n){return!i.isArray(e)||!i.isFinite(t)||1>t?!1:e.length>t?new i.ValidationError(n||"target","should be a maximum of "+t+" items"):null}},maxLength:{attributes:{min:1},input:"number",type:"string",method:function(e,t,n){return!i.isString(e)||!i.isFinite(t)||1>t?!1:e.length>t?new i.ValidationError(n||"target","should be a maximum of "+t+" chars"):null}},minimum:{input:"number",type:"number",method:function(e,t,n){return i.isFinite(e)&&i.isFinite(t)?t>e?new i.ValidationError(n||"target","should be a minimum of "+t):null:!1}},minItems:{attributes:{min:1},input:"number",multi:!0,method:function(e,t,n){return i.isArray(e)&&i.isFinite(t)?e.length<t?new i.ValidationError(n||"target","should be a minimum of "+t+" items"):null:!1}},minLength:{attributes:{min:1},input:"number",type:"string",method:function(e,t,n){return i.isString(e)&&i.isFinite(t)?e.length<t?new i.ValidationError(n||"target","should be a minimum of "+t+" chars"):null:!1}},multipleOf:{input:"number",type:"number",method:function(e,t,n){return i.isFinite(e)&&i.isFinite(t)?e%t!==0?new i.ValidationError(n||"target","should be divisible by "+t):null:!1}},pattern:{input:"text",options:i.keys(t.patterns),type:"string",method:function(e,n,r){var a=i.isString(e)&&i.isString(n,!0)&&(t.patterns[n]||n);return i.isString(a)&&i.isRegExp(a=i.toRegExp(n))&&(t.patterns[n]=a),a?a.test(e)?null:new i.InvalidError(r||"target"):!1}},required:{input:"checkbox",method:function(e,t,n){return t&&i.isEmpty(e)?new i.RequiredError(n||"target"):null}},type:{options:i.keys(t.types),required:!0,method:function(e,n,r){return!i.has(t.types,n||"any")||t.types[n||"any"](e)||i.isNull(e)?null:new i.ArgumentError(r,n||"any")}},uniqueItems:{input:"checkbox",multi:!0,method:function(e,t,n){return i.isArray(e)?t&&!i.isUniq(e)?new i.ValidationError(n||"target","should not have duplicates"):null:!1}}}}("undefined"!=typeof window?window:global);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"expandjs":1}]},{},[2])(2)
});


//# sourceMappingURL=xp-schema.min.map