(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.XPSchema = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){

},{}],2:[function(_dereq_,module,exports){
module.exports=_dereq_("./lib");
},{"./lib":4}],3:[function(_dereq_,module,exports){
(function (global){
!function(e){"use strict";var n=e.XP||_dereq_("expandjs");module.exports=function(e,o){return n.forOwn(e,function(n,t){o[t]&&o[t].immutable&&delete e[t]}),e}}("undefined"!=typeof window?window:global);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"expandjs":1}],4:[function(_dereq_,module,exports){
(function (global){
!function(t){"use strict";var e=t.XP||_dereq_("expandjs"),i=t.XPEmitter||_dereq_("xp-emitter"),n=_dereq_("./filter"),a=_dereq_("./prepare"),r=_dereq_("./sanitize"),s=_dereq_("./validate"),o=function(t){return e.has(t,"input")||e.has(t,"options")},u=function(t,i){return t=e.assign({handle:i},t),e.withdraw(t,"method"),t},l=e.freeze(e.keys(s.types)),f=e.freeze(e.filter(e.map(r.sanitizers,u),o)),c=e.freeze(e.filter(e.map(s.validators,u),o));module.exports=t.XPSchema=new e.Class("XPSchema",{"extends":i,initialize:function(t){var e=this;i.call(e),e.options=t,e.fields=e.options.fields||{},e.loose=e.options.loose||!1,e.useful=e.options.useful||!1},filter:{promise:!0,value:function(t,i){var a=this;e.waterfall([function(e){a._assert({data:t},e)},function(i){e.attempt(function(e){e(null,n(t,a.fields))},i)}],i)}},prepare:{promise:!0,value:function(t,i){var n=this;e.waterfall([function(e){n._assert({data:t},e)},function(i){e.attempt(function(e){e(null,a(t,n.fields))},i)}],i)}},sanitize:{promise:!0,value:function(t,i){var n=this;e.waterfall([function(e){n._assert({data:t},e)},function(i){e.attempt(function(e){e(null,r(t,n.fields,n.options))},i)}],i)}},validate:{promise:!0,value:function(t,i){var n=this;e.waterfall([function(e){n._assert({data:t},e)},function(i){e.attempt(function(e){e(null,s(t,n.fields,n.options))},i)}],i)}},fields:{validate:function(t){return!e.isObject(t)&&"Object"}},loose:{set:function(t){return!!t}},sanitizers:{"static":!0,get:function(){return f}},types:{"static":!0,get:function(){return l}},useful:{set:function(t){return!!t}},validators:{"static":!0,get:function(){return c}},_assertData:{enumerable:!1,value:function(t){return!e.isObject(t)&&new e.ValidationError("data","Object",400)}}})}("undefined"!=typeof window?window:global);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./filter":3,"./prepare":5,"./sanitize":6,"./validate":7,"expandjs":1,"xp-emitter":1}],5:[function(_dereq_,module,exports){
(function (global){
!function(e){"use strict";var n=e.XP||_dereq_("expandjs");module.exports=function(e,i){return n.forOwn(i,function(o,u){n.isDefined(i.value)&&n.isVoid(e[u])&&(e[u]=o.value)}),e}}("undefined"!=typeof window?window:global);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"expandjs":1}],6:[function(_dereq_,module,exports){
(function (global){
!function(e){"use strict";var i=module.exports,n=e.XP||_dereq_("expandjs");i=module.exports=function(e,t,o,s){return n.forOwn(e,function(i,n){o.loose||t[n]||delete e[n]}),n.forOwn(t,function(u,r){e[r]=i.sanitizeStep(e[r],u,t,o,(s?s+".":"")+r),o.useful&&n.isVoid(e[r])&&delete e[r]}),e},i.sanitizeStep=function(e,t,o,s,u){return e=n.isDefined(e)?e:null,n.isObject(t)?(e=i.sanitizeValue(e,t,null,u),t.map||t.multi?n[t.map?"forOwn":"forEach"](e,function(r,l){e[l]=i.sanitizeValue(r,t,l,u+"["+l+"]"),n.isObject(e[l])&&(t.fields||"recursive"===t.type)&&(e[l]=i(e[l],t.fields||o,n.assign({},s,{loose:t.loose}),u+"["+l+"]"))}):n.isObject(e)&&(t.fields||"recursive"===t.type)&&(e=i(e,t.fields||o,n.assign({},s,{loose:t.loose}),u)),e):e},i.sanitizeValue=function(e,t,o,s){e=n.isDefined(e)?e:null;var u=n.isVoid(o)&&(t.map&&"map"||t.multi&&"multi")||"type",r=i.sanitizers[u].method(e,t[u],s);return n.forOwn(t,function(e,n){i.sanitizers[n]&&"map"!==n&&"multi"!==n&&"type"!==n&&(r=i.sanitizers[n].method(r,e,s))}),r},i.sanitizers={map:{method:function(e,i){return n.isVoid(e)&&i?{}:e}},multi:{method:function(e,i){return n.isVoid(e)&&i?[]:e}},type:{method:function(e,i){return n.isVoid(e)&&"boolean"===i?!1:e}}}}("undefined"!=typeof window?window:global);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"expandjs":1}],7:[function(_dereq_,module,exports){
(function (global){
!function(t){"use strict";var e=module.exports,i=t.XP||_dereq_("expandjs");e=module.exports=function(t,n,r,a){return i.forOwn(n,function(i,u){e.validateStep(t[u],i,n,r,(a?a+".":"")+u)}),t},e.validateStep=function(t,n,r,a,u){return t=i.isDefined(t)?t:null,i.isObject(n)?(e.validateValue(t,n,null,u),n.map||n.multi?i[n.map?"forOwn":"forEach"](t,function(t,s){e.validateValue(t,n,s,u+"["+s+"]"),i.isObject(t)&&(n.fields||"recursive"===n.type)&&e(t,n.fields||r,i.assign({},a,{strict:n.strict}),u+"["+s+"]")}):i.isObject(t)&&(n.fields||"recursive"===n.type)&&e(t,n.fields||r,i.assign({},a,{strict:n.strict}),u),t):t},e.validateValue=function(t,n,r,a){t=i.isDefined(t)?t:null;var u=i.isVoid(r)&&(n.map&&"map"||n.multi&&"multi")||"type",s=e.validators[u].method(t,n[u],a);if(s)throw s;return i.forOwn(n,function(i,n){if(e.validators[n]&&"map"!==n&&"multi"!==n&&"type"!==n&&(s=e.validators[n].method(t,i,a)))throw s}),t},e.patterns={camelCase:i.camelCaseRegex,capitalize:i.capitalizeRegex,kebabCase:i.kebabCaseRegex,keyCase:i.keyCaseRegex,lowerCase:i.lowerCaseRegex,snakeCase:i.snakeCaseRegex,startCase:i.startCaseRegex,trim:i.trimRegex,upperCase:i.upperCaseRegex,uuid:i.uuidRegex},e.types={any:i.isAny,"boolean":i.isBoolean,input:i.isInput,number:i.isFinite,object:i.isObject,recursive:i.isObject,string:i.isString},e.validators={exclusiveMaximum:{input:"number",type:"number",method:function(t,e,n){return i.isFinite(t)&&i.isFinite(e)?t>=e?new i.ValidationError(n||"data","less than "+e,400):null:!1}},exclusiveMinimum:{input:"number",type:"number",method:function(t,e,n){return i.isFinite(t)&&i.isFinite(e)?e>=t?new i.ValidationError(n||"data","greater than "+e,400):null:!1}},map:{input:"checkbox",multi:!0,method:function(t,e,n){return i.xor(e,i.isObject(t))?new i.ValidationError(n||"data","a map",400):null}},maximum:{input:"number",type:"number",method:function(t,e,n){return i.isFinite(t)&&i.isFinite(e)?t>e?new i.ValidationError(n||"data","a maximum of "+e,400):null:!1}},maxItems:{attributes:{min:1},input:"number",multi:!0,method:function(t,e,n){return!i.isArray(t)||!i.isFinite(e)||1>e?!1:t.length>e?new i.ValidationError(n||"data","a maximum of "+e+" items",400):null}},maxLength:{attributes:{min:1},input:"number",type:"string",method:function(t,e,n){return!i.isString(t)||!i.isFinite(e)||1>e?!1:t.length>e?new i.ValidationError(n||"data","a maximum of "+e+" chars",400):null}},minimum:{input:"number",type:"number",method:function(t,e,n){return i.isFinite(t)&&i.isFinite(e)?e>t?new i.ValidationError(n||"data","a minimum of "+e,400):null:!1}},minItems:{attributes:{min:1},input:"number",multi:!0,method:function(t,e,n){return i.isArray(t)&&i.isFinite(e)?t.length<e?new i.ValidationError(n||"data","a minimum of "+e+" items",400):null:!1}},minLength:{attributes:{min:1},input:"number",type:"string",method:function(t,e,n){return i.isString(t)&&i.isFinite(e)?t.length<e?new i.ValidationError(n||"data","a minimum of "+e+" chars",400):null:!1}},multi:{input:"checkbox",method:function(t,e,n){return i.xor(e,i.isArray(t))?new i.ValidationError(n||"data","multi",400):null}},multipleOf:{input:"number",type:"number",method:function(t,e,n){return i.isFinite(t)&&i.isFinite(e)?t%e!==0?new i.ValidationError(n||"data","divisible by "+e,400):null:!1}},pattern:{input:"text",options:i.keys(e.patterns),type:"string",method:function(t,n,r){var a=i.isString(t)&&i.isString(n,!0)&&(e.patterns[n]||n);return i.isString(a)&&i.isRegExp(a=i.toRegExp(n))&&(e.patterns[n]=a),a?a.test(t)?null:new i.InvalidError(r||"data",400):!1}},required:{input:"checkbox",method:function(t,e,n){return e&&i.isEmpty(t)?new i.RequiredError(n||"data",400):null}},type:{attributes:{required:!0},options:i.keys(e.types),method:function(t,n,r){return!i.has(e.types,n||"any")||e.types[n||"any"](t)||i.isNull(t)?null:new i.ValidationError(r||"data",n||"any",400)}},uniqueItems:{input:"checkbox",multi:!0,method:function(t,e,n){return i.isArray(t)?e&&!i.isUniq(t)?new i.ValidationError(n||"data","should not have duplicates",400):null:!1}}}}("undefined"!=typeof window?window:global);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"expandjs":1}]},{},[2])(2)
});


//# sourceMappingURL=xp-schema.min.map