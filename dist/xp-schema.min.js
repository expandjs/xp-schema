(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.XPSchema = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){

},{}],2:[function(require,module,exports){
module.exports=require("./lib");
},{"./lib":3}],3:[function(require,module,exports){
(function (global){
!function(e){"use strict";var t=require("eventemitter3"),n=e.XP||require("expandjs");module.exports=new n.Class("XPEmitter",{"extends":t})}("undefined"!=typeof window?window:global);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"eventemitter3":4,"expandjs":1}],4:[function(require,module,exports){
"use strict";function EE(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function EventEmitter(){}EventEmitter.prototype._events=void 0,EventEmitter.prototype.listeners=function(t){if(!this._events||!this._events[t])return[];if(this._events[t].fn)return[this._events[t].fn];for(var e=0,n=this._events[t].length,s=new Array(n);n>e;e++)s[e]=this._events[t][e].fn;return s},EventEmitter.prototype.emit=function(t,e,n,s,r,i){if(!this._events||!this._events[t])return!1;var v,o,h=this._events[t],E=arguments.length;if("function"==typeof h.fn){switch(h.once&&this.removeListener(t,h.fn,!0),E){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,n),!0;case 4:return h.fn.call(h.context,e,n,s),!0;case 5:return h.fn.call(h.context,e,n,s,r),!0;case 6:return h.fn.call(h.context,e,n,s,r,i),!0}for(o=1,v=new Array(E-1);E>o;o++)v[o-1]=arguments[o];h.fn.apply(h.context,v)}else{var f,c=h.length;for(o=0;c>o;o++)switch(h[o].once&&this.removeListener(t,h[o].fn,!0),E){case 1:h[o].fn.call(h[o].context);break;case 2:h[o].fn.call(h[o].context,e);break;case 3:h[o].fn.call(h[o].context,e,n);break;default:if(!v)for(f=1,v=new Array(E-1);E>f;f++)v[f-1]=arguments[f];h[o].fn.apply(h[o].context,v)}}return!0},EventEmitter.prototype.on=function(t,e,n){var s=new EE(e,n||this);return this._events||(this._events={}),this._events[t]?this._events[t].fn?this._events[t]=[this._events[t],s]:this._events[t].push(s):this._events[t]=s,this},EventEmitter.prototype.once=function(t,e,n){var s=new EE(e,n||this,!0);return this._events||(this._events={}),this._events[t]?this._events[t].fn?this._events[t]=[this._events[t],s]:this._events[t].push(s):this._events[t]=s,this},EventEmitter.prototype.removeListener=function(t,e,n){if(!this._events||!this._events[t])return this;var s=this._events[t],r=[];if(e&&(s.fn&&(s.fn!==e||n&&!s.once)&&r.push(s),!s.fn))for(var i=0,v=s.length;v>i;i++)(s[i].fn!==e||n&&!s[i].once)&&r.push(s[i]);return r.length?this._events[t]=1===r.length?r[0]:r:delete this._events[t],this},EventEmitter.prototype.removeAllListeners=function(t){return this._events?(t?delete this._events[t]:this._events={},this):this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prototype.setMaxListeners=function(){return this},EventEmitter.EventEmitter=EventEmitter,EventEmitter.EventEmitter2=EventEmitter,EventEmitter.EventEmitter3=EventEmitter,module.exports=EventEmitter;
},{}],5:[function(require,module,exports){
arguments[4][2][0].apply(exports,arguments)
},{"./lib":7,"dup":2}],6:[function(require,module,exports){
(function (global){
!function(e){"use strict";var n=e.XP||require("expandjs");module.exports=function(e,o){return n.forOwn(e,function(t,i){n.has(o,i)&&o[i].immutable&&delete e[i]}),e}}("undefined"!=typeof window?window:global);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"expandjs":1}],7:[function(require,module,exports){
(function (global){
!function(t){"use strict";var i=t.XP||require("expandjs"),e=t.XPEmitter||require("xp-emitter"),n=require("./filter"),r=require("./sanitize"),s=require("./validate"),o=function(t){return i.has(t,"input")||i.has(t,"options")},u=function(t,e){return t=i.assign({handle:e},t),i.withdraw(t,"method"),t},a=i.freeze(i.keys(s.types)),l=i.freeze(i.filter(i.map(r.sanitizers,u),o)),f=i.freeze(i.filter(i.map(s.validators,u),o));module.exports=new i.Class("XPSchema",{"extends":e,options:{id:"",fields:null,strict:!1,useful:!1},initialize:function(t){var i=this;e.call(i),i.options=t,i.id=i.options.id,i.fields=i.options.fields||{},i.strict=i.options.strict,i.useful=i.options.useful},filter:{promise:!0,value:function(t,e){var r=this;i.waterfall([function(e){e(!i.isObject(t)&&new i.ValidationError("target","Object")||null)},function(e){i.attempt(function(i){i(null,n(t,r.fields,r.options))},e)}],e)}},sanitize:{promise:!0,value:function(t,e){var n=this;i.waterfall([function(e){e(!i.isObject(t)&&new i.ValidationError("target","Object")||null)},function(e){i.attempt(function(i){i(null,r(t,n.fields,n.options))},e)}],e)}},validate:{promise:!0,value:function(t,e){var n=this;i.waterfall([function(e){e(!i.isObject(t)&&new i.ValidationError("target","Object")||null)},function(e){i.attempt(function(i){i(null,s(t,n.fields,n.options))},e)}],e)}},fields:{set:function(t){return i.assign(t,i.zipObject(this.id,{type:"string"}))},validate:function(t){return i.isObject(t)}},id:{set:function(t){return this.id||t},validate:function(t){return i.isString(t,!0)}},sanitizers:{"static":!0,get:function(){return l}},strict:{set:function(t){return!!t}},types:{"static":!0,get:function(){return a}},useful:{set:function(t){return!!t}},validators:{"static":!0,get:function(){return f}}})}("undefined"!=typeof window?window:global);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./filter":6,"./sanitize":8,"./validate":9,"expandjs":1,"xp-emitter":2}],8:[function(require,module,exports){
(function (global){
!function(i){"use strict";var e=module.exports,t=i.XP||require("expandjs");e=module.exports=function(i,n,s,o){return t.forOwn(i,function(e,t){s.strict&&!n[t]&&delete i[t]}),t.forOwn(n,function(r,u){i[u]=e.sanitizeStep(i[u],r,n,s,(o?o+".":"")+u),s.useful&&t.isVoid(i[u])&&delete i[u]}),i},e.sanitizeStep=function(i,n,s,o,r){return i=t.isDefined(i)?i:null,t.isObject(n)?(i=e.sanitizeValue(i,n,null,r),n.map||n.multi?t[n.map?"forOwn":"forEach"](i,function(u,a){i[a]=e.sanitizeValue(u,n,a,r+"["+a+"]"),t.isObject(i[a])&&(n.fields||"recursive"===n.type)&&(i[a]=e(i[a],n.fields||s,t.assign({},o,{strict:n.strict}),r+"["+a+"]"))}):t.isObject(i)&&(n.fields||"recursive"===n.type)&&(i=e(i,n.fields||s,t.assign({},o,{strict:n.strict}),r)),i):i},e.sanitizeValue=function(i,n,s,o){return i=t.isDefined(i)?i:null,i=n.map&&t.isVoid(s)?e.sanitizers.map.method(i,n.map,o):n.multi&&t.isVoid(s)?e.sanitizers.multi.method(i,n.multi,o):e.sanitizers.type.method(i,n.type,o),t.forOwn(n,function(t,s){e.sanitizers[s]&&"map"!==s&&"multi"!==s&&"type"!==s&&(i=e.sanitizers[s].method(i,n[s],o))}),i},e.sanitizers={map:{method:function(i,e){return t.isVoid(i)&&e?{}:i}},multi:{method:function(i,e){return t.isVoid(i)&&e?[]:i}},type:{method:function(i,e){return t.isVoid(i)&&"boolean"===e?!1:i}}}}("undefined"!=typeof window?window:global);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"expandjs":1}],9:[function(require,module,exports){
(function (global){
!function(e){"use strict";var t=module.exports,i=e.XP||require("expandjs");t=module.exports=function(e,n,r,a){return i.forOwn(n,function(i,u){t.validateStep(e[u],i,n,r,(a?a+".":"")+u)}),e},t.validateStep=function(e,n,r,a,u){return e=i.isDefined(e)?e:null,i.isObject(n)?(t.validateValue(e,n,null,u),n.map||n.multi?i[n.map?"forOwn":"forEach"](e,function(e,s){t.validateValue(e,n,s,u+"["+s+"]"),i.isObject(e)&&(n.fields||"recursive"===n.type)&&t(e,n.fields||r,i.assign({},a,{strict:n.strict}),u+"["+s+"]")}):i.isObject(e)&&(n.fields||"recursive"===n.type)&&t(e,n.fields||r,i.assign({},a,{strict:n.strict}),u),e):e},t.validateValue=function(e,n,r,a){var u;if(e=i.isDefined(e)?e:null,n.map&&i.isVoid(r)){if(i.isError(u=t.validators.map.method(e,n.map,a)))throw u}else if(n.multi&&i.isVoid(r)){if(i.isError(u=t.validators.multi.method(e,n.multi,a)))throw u}else if(i.isError(u=t.validators.type.method(e,n.type,a)))throw u;return i.forOwn(n,function(r,s){if(t.validators[s]&&"map"!==s&&"multi"!==s&&"type"!==s&&i.isError(u=t.validators[s].method(e,n[s],a)))throw u}),e},t.patterns={camelCase:i.camelCaseRegex,capitalize:i.capitalizeRegex,kebabCase:i.kebabCaseRegex,keyCase:i.keyCaseRegex,lowerCase:i.lowerCaseRegex,readable:i.readableRegex,snakeCase:i.snakeCaseRegex,startCase:i.startCaseRegex,trim:i.trimRegex,upperCase:i.upperCaseRegex},t.types={any:i.isAny,"boolean":i.isBoolean,number:i.isFinite,object:i.isObject,recursive:i.isObject,string:i.isString},t.validators={exclusiveMaximum:{input:"number",type:"number",method:function(e,t,n){return i.isFinite(e)&&i.isFinite(t)?e>=t?new i.ValidationError(n||"target","should be less than "+t):null:!1}},exclusiveMinimum:{input:"number",type:"number",method:function(e,t,n){return i.isFinite(e)&&i.isFinite(t)?t>=e?new i.ValidationError(n||"target","should be greater than "+t):null:!1}},map:{input:"checkbox",multi:!0,method:function(e,t,n){return i.xor(t,i.isObject(e))?new i.ValidationError(n||"target","should be an map"):null}},maximum:{input:"number",type:"number",method:function(e,t,n){return i.isFinite(e)&&i.isFinite(t)?e>t?new i.ValidationError(n||"target","should be a maximum of "+t):null:!1}},maxItems:{attributes:{min:1},input:"number",multi:!0,method:function(e,t,n){return!i.isArray(e)||!i.isFinite(t)||1>t?!1:e.length>t?new i.ValidationError(n||"target","should be a maximum of "+t+" items"):null}},maxLength:{attributes:{min:1},input:"number",type:"string",method:function(e,t,n){return!i.isString(e)||!i.isFinite(t)||1>t?!1:e.length>t?new i.ValidationError(n||"target","should be a maximum of "+t+" chars"):null}},minimum:{input:"number",type:"number",method:function(e,t,n){return i.isFinite(e)&&i.isFinite(t)?t>e?new i.ValidationError(n||"target","should be a minimum of "+t):null:!1}},minItems:{attributes:{min:1},input:"number",multi:!0,method:function(e,t,n){return i.isArray(e)&&i.isFinite(t)?e.length<t?new i.ValidationError(n||"target","should be a minimum of "+t+" items"):null:!1}},minLength:{attributes:{min:1},input:"number",type:"string",method:function(e,t,n){return i.isString(e)&&i.isFinite(t)?e.length<t?new i.ValidationError(n||"target","should be a minimum of "+t+" chars"):null:!1}},multi:{input:"checkbox",method:function(e,t,n){return i.xor(t,i.isArray(e))?new i.ValidationError(n||"target","should be a multi"):null}},multipleOf:{input:"number",type:"number",method:function(e,t,n){return i.isFinite(e)&&i.isFinite(t)?e%t!==0?new i.ValidationError(n||"target","should be divisible by "+t):null:!1}},pattern:{input:"text",options:i.keys(t.patterns),type:"string",method:function(e,n,r){var a=i.isString(e)&&i.isString(n,!0)&&(t.patterns[n]||n);return i.isString(a)&&i.isRegExp(a=i.toRegExp(n))&&(t.patterns[n]=a),a?a.test(e)?null:new i.InvalidError(r||"target"):!1}},required:{input:"checkbox",method:function(e,t,n){return t&&i.isEmpty(e)?new i.RequiredError(n||"target"):null}},type:{attributes:{required:!0},options:i.keys(t.types),method:function(e,n,r){return!i.has(t.types,n||"any")||t.types[n||"any"](e)||i.isNull(e)?null:new i.ArgumentError(r,n||"any")}},uniqueItems:{input:"checkbox",multi:!0,method:function(e,t,n){return i.isArray(e)?t&&!i.isUniq(e)?new i.ValidationError(n||"target","should not have duplicates"):null:!1}}}}("undefined"!=typeof window?window:global);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"expandjs":1}]},{},[5])(5)
});


//# sourceMappingURL=xp-schema.min.map