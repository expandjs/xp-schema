!function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var i={};t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t){e.exports=XP},function(e,t,i){(function(t){const n="undefined"!=typeof window?window:t,r=n.XP||i(1),s=n.XPEmitter||i(9),o=i(4),u=i(5),c=i(6),a=i(7),l=i(8);e.exports=n.XPSchema=new r.Class("XPSchema",{extends:s,initialize(e){s.call(this),this.fields=e,this.mapped=r.findDeep(this.fields,e=>e&&r.isString(e.alias,!0))},getField(e){if(r.assertArgument(r.isVoid(e)||r.isString(e,!0),1,"string"),!e)return null;let t=this,i=this.fields,n=e.split(".");return n=n.map(e=>{i=t&&t.fields;e=Object.keys(i||{}).find(t=>e===i[t].alias)||e;t=i&&i[e];return e}),r.get(this.fields,n.join("."))||null},filter:{callback:!0,value(e,t,i){r.waterfall([t=>this._assert({item:e},t),i=>i(null,o(this,e,{reading:t}))],i)}},map:{callback:!0,value(e,t,i){r.waterfall([t=>this._assert({item:e},t),i=>i(null,this.mapped?u(this,e,{reading:t}):e)],i)}},restrict:{callback:!0,value(e,t,i){r.waterfall([t=>this._assert({item:e},t),i=>i(null,c(this,e,{reading:t}))],i)}},sanitize:{callback:!0,value(e,t,i,n){r.waterfall([n=>this._assert({namespace:e,item:t,current:i},n),n=>r.attempt(n=>n(null,a(this,t,{current:i,path:e})),n)],e=>n(e||null))}},validate:{callback:!0,value(e,t,i,n){r.waterfall([n=>this._assert({namespace:e,item:t,current:i},n),n=>r.attempt(n=>n(null,l(this,t,{current:i,path:e})),n)],n)}},_assert:{callback:!0,enumerable:!1,value(e,t){r.iterate(e,(e,t,i)=>e(this["_assert"+r.capitalize(i)](t)),t)}},fields:{set(e){return this.fields||e},validate(e){return!r.isObject(e)&&"Object"}},mapped:{set(e){return r.isDefined(this.mapped)?this.mapped:!!e}},sanitizers:{static:!0,writable:!1,value:Object.freeze(Object.keys(a.sanitizers))},types:{static:!0,writable:!1,value:Object.freeze(Object.keys(l.types))},validators:{static:!0,writable:!1,value:Object.freeze(Object.keys(l.validators))},_assertCurrent:{enumerable:!1,value(e){return!r.isVoid(e)&&!r.isObject(e)&&r.error(400,'Schema failed due to invalid "current"')}},_assertItem:{enumerable:!1,value(e){return!r.isObject(e)&&r.error(400,'Schema failed due to invalid "item"')}},_assertNamespace:{enumerable:!1,value(e){return!r.isVoid(e)&&!r.isString(e)&&r.error(400,'Schema failed due to invalid "namespace"')}}})}).call(t,i(0))},function(e,t,i){e.exports=i(2)},function(e,t,i){(function(t){const n="undefined"!=typeof window?window:t,r=n.XP||i(1);e.exports=function(t,i,n){return Object.keys(i).forEach(s=>{let o=Object.keys(t.fields||{}).find(e=>t.fields[e].alias===s)||s,u=t.fields[o],c=i[s];if(!u||"reserved"===u.access||"readonly"===u.access&&!n.reading)return void delete i[s];if(!u.fields&&!u.recursive)return;if(!u.list)return r.isObject(c)&&e.exports(u.recursive?t:u,c,n);Array.from(r.isArray(c)?c:[]).forEach(i=>r.isObject(i)&&e.exports(u.recursive?t:u,i,n))}),i}}).call(t,i(0))},function(e,t,i){(function(t){const n="undefined"!=typeof window?window:t,r=n.XP||i(1);e.exports=function(t,i,n){return Object.keys(i).forEach(s=>{let o=!n.reading&&Object.keys(t.fields||{}).find(e=>t.fields[e].alias===s)||s,u=t.fields[o]&&t.fields[o].alias||o,c=t.fields[o],a=i[s];if(!c)return;i[n.reading?u:o]=a;u!==o&&delete i[n.reading?o:u];if(!c.fields&&!c.recursive)return;if(!c.list)return r.isObject(a)&&e.exports(c.recursive?t:c,a,n);Array.from(r.isArray(a)?a:[]).forEach(i=>r.isObject(i)&&e.exports(c.recursive?t:c,i,n))}),i}}).call(t,i(0))},function(e,t,i){(function(t){const n="undefined"!=typeof window?window:t,r=n.XP||i(1);e.exports=function(t,i,n){return Object.keys(i).forEach(s=>{let o=!n.reading&&Object.keys(t.fields||{}).find(e=>t.fields[e].alias===s)||s,u=t.fields[o],c=i[s];if(!u)return void delete i[s];if(!u.fields&&!u.recursive)return;if(!u.list)return r.isObject(c)&&e.exports(u.recursive?t:u,c,n);Array.from(r.isArray(c)?c:[]).forEach(i=>r.isObject(i)&&e.exports(u.recursive?t:u,i,n))}),i}}).call(t,i(0))},function(e,t,i){(function(t){function n(t,i,n){let r=s.isVoid(n.index)&&t.list?"list":"type",o=e.exports.sanitizers[r](s.toUseful(i,!0),t[r]),u=e.exports.validators[r](o,t[r],n.path);if(u)throw u;return o}const r="undefined"!=typeof window?window:t,s=r.XP||i(1);e.exports=function(t,i,r){return Object.keys(t.fields||{}).forEach(o=>{let u=t.fields[o].alias||o,c=t.fields[o],a=r.path?`${r.path}.${u}`:u,l=r.current&&r.current[u];i[u]=n(c,r.current||s.isUseful(i[u])||!s.isUseful(c.value)?i[u]:s.isFunction(c.value)?c.value():c.value,{path:a});if(!c.list)return s.isObject(i[u])&&(i[u]=e.exports(c.recursive?t:c,i[u],{current:l,path:a}));s.isArray(i[u])&&i[u].forEach((r,o)=>{i[u][o]=r=n(c,r,{path:`${a}.${o}`,index:o});return s.isObject(r)&&(i[u][o]=e.exports(c.recursive?t:c,r,{current:l&&l[o],path:`${a}.${o}`}))})}),i},e.exports.types={boolean:s.isBoolean,date:s.isDate,number:s.isFinite,object:s.isObject,recursive:s.isObject,string:s.isString,uuid:s.isUUID},e.exports.sanitizers={list(e,t){return t&&s.isVoid(e)?[]:t&&s.isString(e)?e.split(","):t&&!s.isArray(e)?[e]:e},type(e,t){let i=s.isDefined(e)&&["boolean","date","number","string"].includes(t)?s.toPrimitive(e,t,!0):e;return s.isDefined(i)?(null!==i||"boolean"!==t)&&i:s.isDefined(e)?(null!==e||"boolean"!==t)&&e:"boolean"!==t&&null}},e.exports.validators={list(e,t,i){return t&&!s.isArray(e)?s.error(400,`${i?`"${i}"`:"item"} must be a list`):null},type(t,i,n){return!e.exports.types[i]||e.exports.types[i](t)||s.isVoid(t)?null:s.error(400,`${n?`"${n}"`:"item"} must be ${i}`)}}}).call(t,i(0))},function(e,t,i){(function(t){function n(t,i,n){let r=s.isVoid(n.index)&&t.list?"list":"type",o=e.exports.validators[r](i,t[r],n.path);if(o)throw o;return Object.keys(t).forEach(r=>{if(!e.exports.validators[r]||["list","type"].includes(r)||"statement"===r&&!n.current)return;if(s.isTruthy(o=e.exports.validators[r](i,t[r],n.path,n.memento)))throw o}),i}const r="undefined"!=typeof window?window:t,s=r.XP||i(1);e.exports=function(t,i,r){return Object.keys(t.fields||{}).forEach(o=>{let u=t.fields[o].alias||o,c=t.fields[o],a=r.path?`${r.path}.${u}`:u,l=r.current&&r.current[u];n(c,i[u],{current:r.current,memento:l,path:a});if(!c.list)return s.isObject(i[u])&&e.exports(c.recursive?t:c,i[u],{current:l,path:a});s.isArray(i[u])&&i[u].forEach((i,o)=>{n(c,i,{current:r.current,memento:l&&l[o],path:`${a}.${o}`,index:o});return s.isObject(i)&&e.exports(c.recursive?t:c,i,{current:l&&l[o],path:`${a}.${o}`})})}),i},e.exports.types={boolean:s.isBoolean,date:s.isDate,number:s.isFinite,object:s.isObject,recursive:s.isObject,string:s.isString,uuid:s.isUUID},e.exports.validators={list(e,t,i){return t&&!s.isArray(e)?s.error(400,`${i?`"${i}"`:`item`} must be a list.`):null},max(e,t,i){return!(!s.isFinite(e)||!s.isFinite(t))&&(e>t?s.error(400,`${i?`"${i}"`:`item`} must be up to ${t}.`):null)},maxDate(e,t,i){return!(!s.isDefined(e=s.toDate(e))||!s.isDefined(t=s.toDate(t)))&&(e>t?s.error(400,`${i?`"${i}"`:`item`} must be up to ${s.toDate(t).toISOString()}.`):null)},maxExclusive(e,t,i){return!(!s.isFinite(e)||!s.isFinite(t))&&(e>=t?s.error(400,`${i?`"${i}"`:`item`} must be lower than ${t}.`):null)},maxExclusiveDate(e,t,i){return!(!s.isDefined(e=s.toDate(e))||!s.isDefined(t=s.toDate(t)))&&(e>=t?s.error(400,`${i?`"${i}"`:`item`} must be lower than ${s.toDate(t).toISOString()}.`):null)},maxItems(e,t,i){return!(!s.isArray(e,!0)||!s.isFinite(t)||t<1)&&(e.length>t?s.error(400,`${i?`"${i}"`:`item`} must be up to ${t} items.`):null)},maxLength(e,t,i){return!(!s.isString(e)||!s.isFinite(t)||t<1)&&(e.length>t?s.error(400,`${i?`"${i}"`:`item`} must be up to ${t} chars.`):null)},min(e,t,i){return!(!s.isFinite(e)||!s.isFinite(t))&&(e<t?s.error(400,`${i?`"${i}"`:`item`} must be at least ${t}.`):null)},minDate(e,t,i){return!(!s.isDefined(e=s.toDate(e))||!s.isDefined(t=s.toDate(t)))&&(e<t?s.error(400,`${i?`"${i}"`:`item`} must be at least ${s.toDate(t).toISOString()}.`):null)},minExclusive(e,t,i){return!(!s.isFinite(e)||!s.isFinite(t))&&(e<=t?s.error(400,`${i?`"${i}"`:`item`} must be greater than ${t}.`):null)},minExclusiveDate(e,t,i){return!(!s.isDefined(e=s.toDate(e))||!s.isDefined(t=s.toDate(t)))&&(e<=t?s.error(400,`${i?`"${i}"`:`item`} must be greater than ${s.toDate(t).toISOString()}.`):null)},minItems(e,t,i){return!(!s.isArray(e,!0)||!s.isFinite(t)||t<1)&&(e.length<t?s.error(400,`${i?`"${i}"`:`item`} must be at least ${t} items.`):null)},minLength(e,t,i){return!(!s.isString(e)||!s.isFinite(t))&&(e.length<t?s.error(400,`${i?`"${i}"`:`item`} must be at least ${t} chars.`):null)},options(e,t,i){return!!(s.isUseful(e)&&s.isPrimitive(e)&&s.isArray(t,!0))&&(t.includes(e)?null:s.error(400,`${i?`"${i}"`:`item`} is not valid.`))},pattern(e,t,i){return!(!s.isString(e)||!s.isString(t,!0)&&!s.isRegExp(t))&&(s.isVoid(t=s.toRegExp(t))||t.test(e)?null:s.error(400,`${i?`"${i}"`:`item`} is not valid.`))},required(e,t,i){return t&&(!s.isUseful(e)||s.isFalse(e)||s.isArray(e,!1))?s.error(400,`${i?`"${i}"`:`item`} must be set.`):null},statement(e,t,i,n){return"const"!==t||s.isEquivalent(e,n)?"final"!==t||s.isVoid(n)||s.isEquivalent(e,n)?null:s.error(409,`${i?`"${i}"`:`item`} isn't rewritable.`):s.error(409,`${i?`"${i}"`:`item`} is immutable.`)},step(e,t,i){return!(!s.isFinite(e)||!s.isFinite(t))&&(e%t!=0?s.error(400,`${i?`"${i}"`:`item`} must be divisible by ${t}.`):null)},type(t,i,n){return!e.exports.types[i]||e.exports.types[i](t)||s.isVoid(t)?null:s.error(400,`${n?`"${n}"`:`item`} must be ${i}.`)},unique(e,t,i){return!!s.isArray(e)&&(t&&!s.isUniq(e)?s.error(400,`${i?`"${i}"`:`item`} must be duplicates free.`):null)}}}).call(t,i(0))},function(e,t){e.exports=XPEmitter}]);