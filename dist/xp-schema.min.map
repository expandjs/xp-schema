{"version":3,"sources":["../browserify/node_modules/browser-pack/_prelude.js","../browserify/lib/_empty.js","lib/filter.js","lib/index.js","lib/sanitize.js","lib/validate.js","index"],"names":[],"mappings":"AAAA;ACAA;;ACAA;;ACAA;;ACAA;;ACAA;;ACAA","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",null,"!function(){\"use strict\";var e=require(\"expandjs\");module.exports=function(t,n){return e.isObject(n)?(e.forOwn(t,function(r,u){e.has(n,u)&&n[u].immutable&&delete t[u]}),t):t}}();","!function(){\"use strict\";var t=require(\"./filter\"),e=require(\"./sanitize\"),i=require(\"./validate\"),n=require(\"expandjs\"),s=function(t){return n.has(t,\"input\")||n.has(t,\"options\")},r=function(t,e){return t=n.assign({handle:e},t),n.withdraw(t,\"method\"),t},u=n.freeze(n.keys(i.types)),a=n.freeze(n.filter(n.map(e.sanitizers,r),s)),o=n.freeze(n.filter(n.map(i.validators,r),s));module.exports=new n.Class(\"XPSchema\",{options:{id:\"\",fields:null,strict:!1,useful:!1},initialize:function(t){var e=this;e.options=t,e.id=e.options.id,e.fields=e.options.fields||{},e.strict=e.options.strict,e.useful=e.options.useful},filter:{promise:!0,value:function(e,i){var s=this;n.attempt(function(i){i(null,t(s.ensure(e,\"target\"),s.fields,s.options))},i)}},sanitize:{promise:!0,value:function(t,i){var s=this;n.attempt(function(i){i(null,e(s.ensure(t,\"target\"),s.fields,s.options))},i)}},validate:{promise:!0,value:function(t,e){var s=this;n.attempt(function(e){e(null,i(s.ensure(t,\"target\"),s.fields,s.options))},e)}},ensure:{enumerable:!1,value:function(t,e){var i=this;switch(e){case\"target\":return n.isObject(t=JSON.parse(n.toJSON(t,i.options.useful)))?t:{};case\"opt\":return n.assign({},i.options,t);default:return t}}},fields:{set:function(t){return n.assign(t,n.zipObject(this.id,{type:\"string\"}))},validate:function(t){return n.isObject(t)}},id:{set:function(t){return this.id||t},validate:function(t){return n.isString(t,!0)}},sanitizers:{\"static\":!0,get:function(){return a}},strict:{set:function(t){return!!t}},types:{\"static\":!0,get:function(){return u}},useful:{set:function(t){return!!t}},validators:{\"static\":!0,get:function(){return o}}})}();","!function(){\"use strict\";var t=module.exports,e=require(\"expandjs\");t=module.exports=function(i,n,s,r){return e.isObject(n)?(e.forOwn(i,function(t,r){s.strict&&!e.has(n,r)&&delete i[r]}),e.forOwn(n,function(e,u){i[u]=t.sanitizeStep(i[u],n[u],n,s,(r?r+\".\":\"\")+u),s.useful&&null===i[u]&&delete i[u]}),i):i},t.sanitizeStep=function(i,n,s,r,u){return i=e.isDefined(i)?i:null,e.isObject(n)?(i=t.sanitizeValue(i,n,null,u),n.multi&&e.isArray(i)&&i.forEach(function(o,a){i[a]=t.sanitizeValue(o,n,a,u+\"[\"+a+\"]\"),e.isObject(i[a])&&(n.fields||\"recursive\"===n.type)&&(i[a]=t(i[a],n.fields||s,e.assign({},r,{strict:n.strict}),u+\"[\"+a+\"]\"))}),n.map&&e.isObject(i)&&(n.fields||\"recursive\"===n.type)&&(i=t(i,n.fields||s,e.assign({},r,{strict:n.strict}),u)),i):i},t.sanitizeValue=function(i,n,s,r){return i=e.isDefined(i)?i:null,e.isObject(n)?(e.isVoid(s)?i=(n.map?t.sanitizers.map:t.sanitizers.multi).method(i,n.multi,r):n.multi||(i=t.sanitizers.type.method(i,n.type,r)),e.forOwn(n,function(s,u){e.has(t.sanitizers,u)&&!e.includes([\"map\",\"multi\",\"type\"],u)&&(i=t.sanitizers[u].method(i,n[u],r))}),i):i},t.sanitizers={format:{options:e.formats,type:\"string\",method:function(t,i){return e.isString(t,!0)&&e.has(e,i)?e[i](t):t}},map:{method:function(t,i){return i?e.toObject(t,!0):t}},multi:{method:function(t,i){return i?e.toArray(t,!0):t}},type:{method:function(t,e){return\"boolean\"!==e?t:!!t}}}}();","!function(){\"use strict\";var t=module.exports,i=require(\"expandjs\");t=module.exports=function(e,n,r,u){return i.isObject(n)?(i.forOwn(n,function(i,s){t.validateStep(e[s],n[s],n,r,(u?u+\".\":\"\")+s)}),e):e},t.validateStep=function(e,n,r,u,s){return e=i.isDefined(e)?e:null,i.isObject(n)?(t.validateValue(e,n,null,s),n.multi&&i.isArray(e)&&e.forEach(function(e,o){t.validateValue(e,n,o,s+\"[\"+o+\"]\"),i.isObject(e)&&(n.fields||\"recursive\"===n.type)&&t(e,n.fields||r,i.assign({},u,{strict:n.strict}),s+\"[\"+o+\"]\")}),n.map&&i.isObject(e)&&(n.fields||\"recursive\"===n.type)&&t(e,n.fields||r,i.assign({},u,{strict:n.strict}),s),e):e},t.validateValue=function(e,n,r,u){var s;if(e=i.isDefined(e)?e:null,!i.isObject(n))return e;if(i.isVoid(r)){if(i.isError(s=(n.map?t.validators.map:t.validators.multi).method(e,n.multi,u)))throw s}else if(!n.multi&&i.isError(s=t.validators.type.method(e,n.type,u)))throw s;return i.forOwn(n,function(r,o){if(i.has(t.validators,o)&&!i.includes([\"map\",\"multi\",\"type\"],o)&&i.isError(s=t.validators[o].method(e,n[o],u)))throw s}),e},t.patterns={custom:{},stock:{}},t.types={any:i.isAny,\"boolean\":i.isBoolean,number:i.isFinite,object:i.isObject,recursive:i.isObject,string:i.isString},t.validators={multi:{input:\"checkbox\",method:function(t,e,n){return i.xor(e,i.isArray(t))?new i.ValidationError(n||\"target\",\"should be a multi\"):null}},map:{input:\"checkbox\",multi:!0,method:function(t,e,n){return i.xor(e,i.isObject(t))?new i.ValidationError(n||\"target\",\"should be an map\"):null}},exclusiveMaximum:{input:\"number\",type:\"number\",method:function(t,e,n){return i.isFinite(t)&&i.isFinite(e)?t>=e?new i.ValidationError(n||\"target\",\"should be less than \"+e):null:!1}},exclusiveMinimum:{input:\"number\",type:\"number\",method:function(t,e,n){return i.isFinite(t)&&i.isFinite(e)?e>=t?new i.ValidationError(n||\"target\",\"should be greater than \"+e):null:!1}},maximum:{input:\"number\",type:\"number\",method:function(t,e,n){return i.isFinite(t)&&i.isFinite(e)?t>e?new i.ValidationError(n||\"target\",\"should be a maximum of \"+e):null:!1}},maxItems:{attributes:{min:1},input:\"number\",multi:!0,method:function(t,e,n){return!i.isArray(t)||!i.isFinite(e)||1>e?!1:t.length>e?new i.ValidationError(n||\"target\",\"should be a maximum of \"+e+\" items\"):null}},maxLength:{attributes:{min:1},input:\"number\",type:\"string\",method:function(t,e,n){return!i.isString(t)||!i.isFinite(e)||1>e?!1:t.length>e?new i.ValidationError(n||\"target\",\"should be a maximum of \"+e+\" chars\"):null}},minimum:{input:\"number\",type:\"number\",method:function(t,e,n){return i.isFinite(t)&&i.isFinite(e)?e>t?new i.ValidationError(n||\"target\",\"should be a minimum of \"+e):null:!1}},minItems:{attributes:{min:1},input:\"number\",multi:!0,method:function(t,e,n){return i.isArray(t)&&i.isFinite(e)?t.length<e?new i.ValidationError(n||\"target\",\"should be a minimum of \"+e+\" items\"):null:!1}},minLength:{attributes:{min:1},input:\"number\",type:\"string\",method:function(t,e,n){return i.isString(t)&&i.isFinite(e)?t.length<e?new i.ValidationError(n||\"target\",\"should be a minimum of \"+e+\" chars\"):null:!1}},multipleOf:{input:\"number\",type:\"number\",method:function(t,e,n){return i.isFinite(t)&&i.isFinite(e)?t%e!==0?new i.ValidationError(n||\"target\",\"should be divisible by \"+e):null:!1}},pattern:{input:\"text\",options:i.keys(t.patterns.stock),type:\"string\",method:function(e,n,r){var u=i.isString(e)&&i.isString(n,!0)?i.has(t.patterns.stock,n)?t.patterns.stock[n]:i.has(t.patterns.custom,n)?t.patterns.custom[n]:n:null;return i.isString(u)&&i.isRegExp(u=i.toRegExp(n))&&(t.patterns.custom[n]=u),u?u.test(e)?null:new i.InvalidError(r||\"target\"):!1}},required:{input:\"checkbox\",method:function(t,e,n){return e&&i.isEmpty(t)?new i.RequiredError(n||\"target\"):null}},type:{options:i.keys(t.types),required:!0,method:function(e,n,r){return!i.has(t.types,n||\"any\")||t.types[n||\"any\"](e)||i.isNull(e)?null:new i.ArgumentError(r,n||\"any\")}},uniqueItems:{input:\"checkbox\",multi:!0,method:function(t,e,n){return i.isArray(t)?e&&!i.isUniq(t)?new i.ValidationError(n||\"target\",\"should not have duplicates\"):null:!1}}}}();","module.exports=require(\"./lib\");"]}